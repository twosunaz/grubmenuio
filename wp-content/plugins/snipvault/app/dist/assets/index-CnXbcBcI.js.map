{"version":3,"file":"index-CnXbcBcI.js","sources":["../../src/components/app/error-log/src/constants.js","../../src/components/app/error-log/src/getErrors.js","../../src/components/app/error-log/index.vue"],"sourcesContent":["import { ref } from \"vue\";\n\nexport const errors = ref([]);\nexport const loading = ref(true);\nexport const folders = ref([]);\nexport const activeFolderID = ref(0);\nexport const openFolders = ref([]);\nexport const selected = ref([]);\nexport const activeSnippetID = ref(null);\nexport const search = ref(\"\");\nexport const pagination = ref({ per_page: 30, page: 1, search: \"\", total: 0, total_pages: 0, search: \"\" });\nexport const searchController = ref(null);\n","import { nextTick } from \"vue\";\nimport { errors, loading, folders, openFolders, activeSnippetID, pagination } from \"./constants.js\";\nimport { lmnFetch } from \"@/assets/js/functions/lmnFetch.js\";\n\n// Store\nimport { useAppStore } from \"@/store/app/app.js\";\nlet appStore;\n\nexport const getErrors = async () => {\n  if (!appStore) {\n    appStore = useAppStore();\n  }\n\n  appStore.updateState(\"loading\", true);\n\n  const args = { endpoint: \"snipvault/v1/errorlog\", params: { status: \"any\", per_page: pagination.value.per_page, search: pagination.value.search, page: pagination.value.page } };\n  const response = await lmnFetch(args);\n\n  appStore.updateState(\"loading\", false);\n  loading.value = false;\n\n  // Something went wrong\n  if (!response) return;\n\n  errors.value = response.data;\n\n  const { totalItems, totalPages } = response;\n\n  // Get total pages and posts from headers\n  pagination.value.total_pages = totalPages;\n  pagination.value.total = totalItems;\n};\n","<script setup>\nimport { ref, computed, watch, watchEffect } from \"vue\";\nimport { errors, loading, folders, activeFolderID, activeSnippetID, search, selected, pagination, searchController } from \"./src/constants.js\";\nimport { getErrors } from \"./src/getErrors.js\";\n\n// Components\nimport AppIcon from \"@/components/utility/icons/index.vue\";\nimport AppButton from \"@/components/utility/app-button/index.vue\";\nimport AppInput from \"@/components/utility/text-input/index.vue\";\nimport AppTextarea from \"@/components/utility/text-area/index.vue\";\nimport CodeEditor from \"@/components/app/code-editor/index.vue\";\n\n// Store\nimport { useAppStore } from \"@/store/app/app.js\";\nconst appStore = useAppStore();\n\n// Functions\nimport { lmnFetch } from \"@/assets/js/functions/lmnFetch.js\";\nimport { notify } from \"@/assets/js/functions/notify.js\";\nimport { inSearch } from \"@/assets/js/functions/inSearch.js\";\n\nconst activeError = ref({});\nconst activeErrorJSON = ref(\"\");\n\nconst returnErrorColor = (errorType) => {\n  if (errorType === \"FATAL\") return \"text-red-600 border-red-600\";\n  if (errorType === \"WARNING\") return \"text-amber-500 border-amber-500\";\n  if (errorType === \"NOTICE\") return \"text-blue-500 border-blue-500\";\n  if (errorType === \"SYNTAX\") return \"text-purple-500 border-purple-500\";\n  if (errorType === \"EXCEPTION\") return \"text-orange-600 border-orange-600\";\n  if (errorType === \"MESSAGE\") return \"text-green-600 border-green-600\";\n  return \"text-zinc-500 border-zinc-500\"; // Default for unknown error types\n};\n\nconst returnErrorIcon = (errorType) => {\n  if (errorType === \"FATAL\") return \"error\";\n  if (errorType === \"WARNING\") return \"warning\";\n  if (errorType === \"NOTICE\") return \"info\";\n  if (errorType === \"SYNTAX\") return \"code\";\n  if (errorType === \"EXCEPTION\") return \"bug_report\";\n  if (errorType === \"MESSAGE\") return \"message\";\n  return \"data_object\"; // Default for unknown error types\n};\n\nconst returnSnippets = computed(() => {\n  return snippets.value.filter((snippet) => inSearch(search.value, JSON.stringify(snippet)));\n});\n\nwatchEffect(() => {\n  if (activeError.value.id) {\n    activeErrorJSON.value = JSON.stringify(activeError.value, null, 2);\n  }\n});\n\nconst previousPage = () => {\n  pagination.value.page--;\n  getErrors();\n};\n\nconst nextPage = () => {\n  pagination.value.page++;\n  getErrors();\n};\n\nwatch(\n  () => pagination.value.search,\n  () => {\n    pagination.value.page = 1;\n    // Cancel any pending request\n    if (searchController.value) {\n      searchController.value.abort();\n    }\n\n    // Create new controller for this request\n    searchController.value = new AbortController();\n\n    getErrors();\n  }\n);\n\ngetErrors();\n</script>\n\n<template>\n  <div class=\"flex flex-row w-full\">\n    <div class=\"flex flex-col h-full max-h-full overflow-hidden relative w-[300px] border-r border-zinc-200 dark:border-zinc-700 shrink-0\">\n      <div class=\"relative w-full border-b border-zinc-200 dark:border-zinc-700\">\n        <input type=\"text\" v-model=\"pagination.search\" :placeholder=\"__('Search errors...', 'snipvault')\" class=\"px-6 py-4 pl-12 w-full bg-white dark:bg-zinc-900 focus:outline-0\" />\n        <AppIcon icon=\"search\" class=\"absolute left-5 top-1/2 -translate-y-1/2 text-zinc-500\" />\n      </div>\n\n      <div class=\"relative w-full border-b border-zinc-200 dark:border-zinc-700 flex flex-row px-5 py-2 pr-3 items-center\">\n        <template v-if=\"!loading\">\n          <div class=\"text-xs text-zinc-500 dark:text-zinc-400 grow\">{{ pagination.total }} {{ __(\"results\", \"snipvault\") }}</div>\n\n          <div class=\"flex flex-row items-center\">\n            <div class=\"text-xs text-zinc-500 dark:text-zinc-400 grow mr-2\">{{ pagination.page }} {{ __(\"of\", \"snipvault\") }} {{ pagination.total_pages }}</div>\n            <AppButton type=\"transparent\" @click=\"previousPage\" :disabled=\"pagination.page <= 1\"><AppIcon icon=\"chevron_left\"></AppIcon></AppButton>\n            <AppButton type=\"transparent\" @click=\"nextPage\" :disabled=\"pagination.page >= pagination.total_pages\"><AppIcon icon=\"chevron_right\"></AppIcon></AppButton>\n          </div>\n        </template>\n\n        <template v-else>\n          <div class=\"grow\">\n            <div class=\"w-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse\"></div>\n          </div>\n          <div class=\"w-8 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse mr-2\"></div>\n          <div class=\"w-8 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse mr-2\"></div>\n        </template>\n      </div>\n\n      <Transition mode=\"out-in\">\n        <!-- Loading indicator -->\n        <div class=\"flex flex-col gap-2 p-3\" v-if=\"loading\">\n          <div v-for=\"index in 4\">\n            <div class=\"w-full rounded-lg bg-zinc-100 dark:bg-zinc-800 h-10 animate-pulse\"></div>\n          </div>\n        </div>\n\n        <div class=\"flex flex-col grow overflow-auto shrink\" v-else>\n          <div class=\"text-center text-zinc-500 dark:text-zinc-400 p-3\" v-if=\"!errors.length && !loading\">\n            {{ __(\"No errors found\", \"snipvault\") }}\n          </div>\n\n          <div\n            v-for=\"error in errors\"\n            class=\"grid grid-cols-3 gap-1 pr-3 cursor-pointer transition-all group relative border-b border-zinc-200 dark:border-zinc-700 pl-0\"\n            :class=\"\n              activeError.id == error.id\n                ? 'text-zinc-900 dark:text-zinc-100 bg-zinc-100 dark:bg-zinc-800'\n                : 'hover:text-zinc-900 hover:dark:text-zinc-100 hover:bg-zinc-100 dark:hover:bg-zinc-800 text-zinc-500 dark:text-zinc-400'\n            \"\n            @click=\"activeError = error\"\n          >\n            <div class=\"text-xs pl-5 border-l-2 font-mono h-full flex flex-col justify-center\" :class=\"returnErrorColor(error.type)\">\n              <span>{{ error.type }}</span>\n            </div>\n\n            <div class=\"flex flex-col justify-center col-span-2 py-3\">\n              <div class=\"line-clamp-[3] break-words break-all overflow-hidden text-sm font-mono\">{{ error.message }}</div>\n            </div>\n          </div>\n        </div>\n      </Transition>\n    </div>\n\n    <div class=\"grow flex flex-row w-full\">\n      <CodeEditor v-if=\"activeError.id\" v-model=\"activeErrorJSON\" language=\"json\" class=\"w-full grow\" />\n\n      <div class=\"border-l border-zinc-200 dark:border-zinc-700 w-[360px] shrink-0 h-full max-h-full overflow-auto flex flex-col\" v-if=\"activeError.id\">\n        <div class=\"col-span-3 flex flex-row place-content-between items-center p-6 border-b border-zinc-200 dark:border-zinc-700 cursor-pointer hover:text-zinc-950 dark:hover:text-zinc-100\">\n          <div class=\"\">{{ __(\"Error info\", \"snipvault\") }}</div>\n        </div>\n\n        <div class=\"grid grid-cols-3 gap-3 p-6\">\n          <!-- Satus -->\n          <div class=\"flex flex-col justify-center\">\n            <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">{{ __(\"Status\", \"snipvault\") }}</span>\n          </div>\n          <div class=\"col-span-2 flex flex-row items-start\">\n            <div class=\"px-2 py-1 text-sm bg-zinc-100 dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700 font-mono\" :class=\"returnErrorColor(activeError.type)\">\n              {{ activeError.type }}\n            </div>\n          </div>\n\n          <!-- Date -->\n          <div class=\"flex flex-col justify-center\">\n            <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">{{ __(\"File\", \"snipvault\") }}</span>\n          </div>\n          <AppInput type=\"text\" v-model=\"activeError.file\" :placeholder=\"__('No file path found', 'snipvault')\" class=\"col-span-2\" :copy=\"true\" :disabled=\"true\" />\n\n          <!-- Date -->\n          <div class=\"flex flex-col justify-center\">\n            <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">{{ __(\"Date\", \"snipvault\") }}</span>\n          </div>\n          <AppInput type=\"text\" v-model=\"activeError.date\" class=\"col-span-2\" :disabled=\"true\" />\n\n          <!-- Time -->\n          <div class=\"flex flex-col justify-center\">\n            <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">{{ __(\"Time\", \"snipvault\") }}</span>\n          </div>\n          <AppInput type=\"text\" v-model=\"activeError.time\" class=\"col-span-2\" :disabled=\"true\" />\n\n          <!-- Message -->\n          <div class=\"flex flex-col pt-2\">\n            <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">{{ __(\"Message\", \"snipvault\") }}</span>\n          </div>\n          <AppTextarea type=\"text\" v-model=\"activeError.message\" class=\"col-span-2\" />\n        </div>\n      </div>\n\n      <div v-else class=\"w-full h-full flex flex-col items-center justify-center p-16\">\n        <AppIcon icon=\"code\" style=\"font-size: 88px\" />\n        <div>{{ __(\"No error selected\", \"snipvault\") }}</div>\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":["errors","ref","loading","search","pagination","searchController","appStore","getErrors","useAppStore","args","response","lmnFetch","totalItems","totalPages","activeError","activeErrorJSON","returnErrorColor","errorType","computed","snippet","inSearch","watchEffect","previousPage","nextPage","watch"],"mappings":"saAEO,MAAMA,EAASC,EAAI,EAAE,EACfC,EAAUD,EAAI,EAAI,EACRA,EAAI,CAAE,CAAA,EACCA,EAAI,CAAC,EACRA,EAAI,CAAE,CAAA,EACTA,EAAI,CAAE,CAAA,EACCA,EAAI,IAAI,EAChC,MAAME,EAASF,EAAI,EAAE,EACfG,EAAaH,EAAI,CAAE,SAAU,GAAI,KAAM,EAAG,OAAQ,GAAI,MAAO,EAAG,YAAa,EAAG,OAAQ,GAAI,EAC5FI,EAAmBJ,EAAI,IAAI,ECLxC,IAAIK,EAEG,MAAMC,EAAY,SAAY,CAC9BD,IACHA,EAAWE,EAAa,GAG1BF,EAAS,YAAY,UAAW,EAAI,EAEpC,MAAMG,EAAO,CAAE,SAAU,wBAAyB,OAAQ,CAAE,OAAQ,MAAO,SAAUL,EAAW,MAAM,SAAU,OAAQA,EAAW,MAAM,OAAQ,KAAMA,EAAW,MAAM,KAAQ,EAC1KM,EAAW,MAAMC,EAASF,CAAI,EAMpC,GAJAH,EAAS,YAAY,UAAW,EAAK,EACrCJ,EAAQ,MAAQ,GAGZ,CAACQ,EAAU,OAEfV,EAAO,MAAQU,EAAS,KAExB,KAAM,CAAE,WAAAE,EAAY,WAAAC,CAAU,EAAKH,EAGnCN,EAAW,MAAM,YAAcS,EAC/BT,EAAW,MAAM,MAAQQ,CAC3B,mwECjBiBJ,EAAY,EAOvB,MAAAM,EAAcb,EAAI,EAAE,EACpBc,EAAkBd,EAAI,EAAE,EAExBe,EAAoBC,GACpBA,IAAc,QAAgB,8BAC9BA,IAAc,UAAkB,kCAChCA,IAAc,SAAiB,gCAC/BA,IAAc,SAAiB,oCAC/BA,IAAc,YAAoB,oCAClCA,IAAc,UAAkB,kCAC7B,gCAacC,EAAS,IACvB,SAAS,MAAM,OAAQC,GAAYC,EAASjB,EAAO,MAAO,KAAK,UAAUgB,CAAO,CAAC,CAAC,CAC1F,EAEDE,EAAY,IAAM,CACZP,EAAY,MAAM,KACpBC,EAAgB,MAAQ,KAAK,UAAUD,EAAY,MAAO,KAAM,CAAC,EACnE,CACD,EAED,MAAMQ,EAAe,IAAM,CACzBlB,EAAW,MAAM,OACPG,EAAA,CACZ,EAEMgB,EAAW,IAAM,CACrBnB,EAAW,MAAM,OACPG,EAAA,CACZ,EAEA,OAAAiB,EACE,IAAMpB,EAAW,MAAM,OACvB,IAAM,CACJA,EAAW,MAAM,KAAO,EAEpBC,EAAiB,OACnBA,EAAiB,MAAM,MAAM,EAIdA,EAAA,MAAQ,IAAI,gBAEnBE,EAAA,CAAA,CAEd,EAEUA,EAAA"}