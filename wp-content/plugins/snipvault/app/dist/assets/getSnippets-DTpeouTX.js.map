{"version":3,"file":"getSnippets-DTpeouTX.js","sources":["../../src/components/app/snippets-list/src/getSnippets.js"],"sourcesContent":["import { nextTick } from \"vue\";\nimport { snippets, loading, folders, openFolders, activeSnippetID } from \"./constants.js\";\nimport { lmnFetch } from \"@/assets/js/functions/lmnFetch.js\";\n\n// Store\nimport { useAppStore } from \"@/store/app/app.js\";\nlet appStore;\n\nexport const getSnippets = async () => {\n  if (!appStore) {\n    appStore = useAppStore();\n  }\n\n  appStore.updateState(\"loading\", true);\n\n  const args = { endpoint: \"wp/v2/svsnippets\", params: { status: \"any\", per_page: 100 } };\n  const response = await lmnFetch(args);\n\n  appStore.updateState(\"loading\", false);\n  loading.value = false;\n\n  // Something went wrong\n  if (!response) return;\n\n  snippets.value = response.data;\n\n  const { totalItems, totalPages } = response;\n\n  await nextTick();\n  setOpenFolders();\n};\n\nexport const setOpenFolders = () => {\n  // No active route id\n  if (!activeSnippetID.value) return;\n\n  const activeSnippet = snippets.value.find((item) => item.id == activeSnippetID.value);\n  if (!activeSnippet) return;\n\n  const activeSnippetFolder = activeSnippet.meta.snippet_settings.folder;\n  if (!activeSnippetFolder) return;\n\n  if (!openFolders.value.includes(activeSnippetFolder)) {\n    openFolders.value.push(activeSnippetFolder);\n  }\n\n  const openFolder = folders.value.find((item) => item.id == activeSnippetFolder);\n\n  if (!openFolder) return;\n\n  const folderRecursive = (folderid) => {\n    for (let folder of folders.value) {\n      if (folder.id == folderid) {\n        if (!openFolders.value.includes(folder.id)) {\n          openFolders.value.push(folder.id);\n        }\n\n        const parentID = folder.meta.folder_parent;\n        if (parentID) folderRecursive(parentID);\n      }\n    }\n  };\n\n  folderRecursive(openFolder.id);\n};\n"],"names":["appStore","getSnippets","useAppStore","response","lmnFetch","loading","snippets","totalItems","totalPages","nextTick","setOpenFolders","activeSnippetID","activeSnippet","item","activeSnippetFolder","openFolders","openFolder","folders","folderRecursive","folderid","folder","parentID"],"mappings":"uKAMA,IAAIA,EAEQ,MAACC,EAAc,SAAY,CAChCD,IACHA,EAAWE,EAAa,GAG1BF,EAAS,YAAY,UAAW,EAAI,EAGpC,MAAMG,EAAW,MAAMC,EADV,CAAE,SAAU,mBAAoB,OAAQ,CAAE,OAAQ,MAAO,SAAU,IAAO,CACnD,EAMpC,GAJAJ,EAAS,YAAY,UAAW,EAAK,EACrCK,EAAQ,MAAQ,GAGZ,CAACF,EAAU,OAEfG,EAAS,MAAQH,EAAS,KAE1B,KAAM,CAAE,WAAAI,EAAY,WAAAC,CAAU,EAAKL,EAEnC,MAAMM,EAAU,EAChBC,EAAgB,CAClB,EAEaA,EAAiB,IAAM,CAElC,GAAI,CAACC,EAAgB,MAAO,OAE5B,MAAMC,EAAgBN,EAAS,MAAM,KAAMO,GAASA,EAAK,IAAMF,EAAgB,KAAK,EACpF,GAAI,CAACC,EAAe,OAEpB,MAAME,EAAsBF,EAAc,KAAK,iBAAiB,OAChE,GAAI,CAACE,EAAqB,OAErBC,EAAY,MAAM,SAASD,CAAmB,GACjDC,EAAY,MAAM,KAAKD,CAAmB,EAG5C,MAAME,EAAaC,EAAQ,MAAM,KAAMJ,GAASA,EAAK,IAAMC,CAAmB,EAE9E,GAAI,CAACE,EAAY,OAEjB,MAAME,EAAmBC,GAAa,CACpC,QAASC,KAAUH,EAAQ,MACzB,GAAIG,EAAO,IAAMD,EAAU,CACpBJ,EAAY,MAAM,SAASK,EAAO,EAAE,GACvCL,EAAY,MAAM,KAAKK,EAAO,EAAE,EAGlC,MAAMC,EAAWD,EAAO,KAAK,cACzBC,GAAUH,EAAgBG,CAAQ,CAC9C,CAEG,EAEDH,EAAgBF,EAAW,EAAE,CAC/B"}