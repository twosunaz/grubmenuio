{"version":3,"file":"index-wpvKez5I.js","sources":["../../src/components/app/library-list/src/constants.js","../../src/components/app/library-list/src/getSnippets.js","../../src/components/app/library-list/index.vue"],"sourcesContent":["import { ref } from \"vue\";\n\nexport const snippets = ref([]);\nexport const search = ref(\"\");\nexport const searchController = ref(null);\nexport const loading = ref(false);\nexport const pagination = ref({ per_page: 20, page: 1, search: \"\", total: 0, total_pages: 0 });\n","import { snippets, search, searchController, loading, pagination } from \"./constants.js\";\nimport { lmnFetch } from \"@/assets/js/functions/lmnFetch.js\";\nimport { notify } from \"@/assets/js/functions/notify.js\";\n// Store\nimport { useAppStore } from \"@/store/app/app.js\";\nlet appStore;\n\nexport const getSnippets = async () => {\n  if (!appStore) {\n    appStore = useAppStore();\n  }\n\n  appStore.updateState(\"loading\", true);\n  loading.value = true;\n\n  // Build query parameters\n  const params = new URLSearchParams({\n    per_page: pagination.value.per_page,\n    page: pagination.value.page,\n    search: pagination.value.search,\n  });\n\n  const args = {\n    headers: {\n      Accept: \"application/json\",\n    },\n  };\n  if (searchController.value) {\n    args.signal = searchController.value.signal;\n  }\n\n  try {\n    // Fetch snippets\n    const endpoint = `https://snips.snipvault.co/wp-json/wp/v2/snippets?${params.toString()}`;\n    const response = await fetch(endpoint, args);\n\n    appStore.updateState(\"loading\", false);\n    loading.value = false;\n\n    // Something went wrong\n    if (!response) return;\n    if (!response.ok) return;\n\n    // Get total pages and posts from headers\n    pagination.value.total_pages = parseInt(response.headers.get(\"X-WP-TotalPages\"), 10);\n    pagination.value.total = parseInt(response.headers.get(\"X-WP-Total\"), 10);\n\n    // Parse response\n    const remoteSnippets = await response.json();\n\n    snippets.value = [...remoteSnippets];\n  } catch (error) {\n    appStore.updateState(\"loading\", false);\n    loading.value = false;\n    if (error.name === \"AbortError\") {\n      //console.log(\"Fetch aborted\");\n    } else {\n      notify({ title: error.name, message: error.message, type: \"error\" });\n    }\n  }\n};\n","<script setup>\nimport { ref, computed, watch } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { snippets, search, searchController, loading, pagination } from \"./src/constants.js\";\nimport { getSnippets } from \"./src/getSnippets.js\";\n\n// Components\nimport AppIcon from \"@/components/utility/icons/index.vue\";\nimport AppButton from \"@/components/utility/app-button/index.vue\";\nimport AppCheckBox from \"@/components/utility/checkbox-basic/index.vue\";\nimport AppInput from \"@/components/utility/text-input/index.vue\";\nimport AppTextarea from \"@/components/utility/text-area/index.vue\";\nimport Confirm from \"@/components/utility/confirm/index.vue\";\nimport Modal from \"@/components/utility/modal/index.vue\";\n\n// Store\nimport { useAppStore } from \"@/store/app/app.js\";\nconst appStore = useAppStore();\n\n// Functions\nimport { lmnFetch } from \"@/assets/js/functions/lmnFetch.js\";\nimport { notify } from \"@/assets/js/functions/notify.js\";\nimport { inSearch } from \"@/assets/js/functions/inSearch.js\";\n\nconst route = useRoute();\nconst router = useRouter();\nconst codeTypes = ref([\n  { label: \"PHP\", open: true, value: \"PHP\" },\n  { label: \"JavaScript\", open: true, value: \"JAVASCRIPT\" },\n  { label: \"css\", open: true, value: \"CSS\" },\n  { label: \"scss\", open: true, value: \"SCSS\" },\n  { label: \"html\", open: true, value: \"HTML\" },\n]);\n\nconst returnSnippetsByType = (codetype) => {\n  return snippets.value.filter((snippet) => snippet.meta.snippet_language == codetype);\n};\n\nconst returnSnippetIcon = (snippet) => {\n  return snippet.meta.snippet_language ? snippet.meta.snippet_language.toLowerCase() : \"file\";\n};\n\nconst returnSnippetColor = (snippet) => {\n  const language = snippet.meta.snippet_language;\n\n  if (language == \"PHP\") return \"text-indigo-400\";\n  if (language == \"JAVASCRIPT\") return \"text-amber-400\";\n  if (language == \"CSS\") return \"text-sky-400\";\n  if (language == \"SCSS\") return \"text-pink-400\";\n  if (language == \"HTML\") return \"text-orange-400\";\n\n  return \"text-sky-400\";\n};\n\nconst previousPage = () => {\n  pagination.value.page--;\n  getSnippets();\n};\n\nconst nextPage = () => {\n  pagination.value.page++;\n  getSnippets();\n};\n\ngetSnippets();\n\nwatch(\n  () => pagination.value.search,\n  () => {\n    pagination.value.page = 1;\n    // Cancel any pending request\n    if (searchController.value) {\n      searchController.value.abort();\n    }\n\n    // Create new controller for this request\n    searchController.value = new AbortController();\n\n    getSnippets();\n  }\n);\n</script>\n\n<template>\n  <div class=\"flex flex-col h-full max-h-full overflow-hidden relative\">\n    <div\n      class=\"p-3 border-b border-zinc-200 dark:border-zinc-700 text-center bg-white dark:bg-zinc-900 transition-all cursor-pointer flex flex-row items-center gap-2 shrink-0\"\n      style=\"min-height: 57px\"\n    >\n      <div class=\"flex flex-row items-center gap-3 grow pl-2 place-content-between\">\n        <span>{{ __(\"Library\", \"snipvault\") }}</span>\n      </div>\n    </div>\n\n    <div class=\"relative w-full border-b border-zinc-200 dark:border-zinc-700\">\n      <input type=\"text\" v-model=\"pagination.search\" :placeholder=\"__('Search snippets...', 'snipvault')\" class=\"px-6 py-4 pl-12 w-full bg-white dark:bg-zinc-900 focus:outline-0\" />\n      <AppIcon icon=\"search\" class=\"absolute left-5 top-1/2 -translate-y-1/2 text-zinc-500\" />\n    </div>\n\n    <div class=\"relative w-full border-b border-zinc-200 dark:border-zinc-700 flex flex-row px-5 py-2 pr-3 items-center\">\n      <template v-if=\"!loading\">\n        <div class=\"text-xs text-zinc-500 dark:text-zinc-400 grow\">{{ pagination.total }} {{ __(\"results\", \"snipvault\") }}</div>\n\n        <div class=\"flex flex-row items-center\">\n          <div class=\"text-xs text-zinc-500 dark:text-zinc-400 grow mr-2\">{{ pagination.page }} {{ __(\"of\", \"snipvault\") }} {{ pagination.total_pages }}</div>\n          <AppButton type=\"transparent\" @click=\"previousPage\" :disabled=\"pagination.page <= 1\"><AppIcon icon=\"chevron_left\"></AppIcon></AppButton>\n          <AppButton type=\"transparent\" @click=\"nextPage\" :disabled=\"pagination.page >= pagination.total_pages\"><AppIcon icon=\"chevron_right\"></AppIcon></AppButton>\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"grow\">\n          <div class=\"w-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse\"></div>\n        </div>\n        <div class=\"w-8 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse mr-2\"></div>\n        <div class=\"w-8 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-4 animate-pulse mr-2\"></div>\n      </template>\n    </div>\n\n    <!-- Loading indicator -->\n    <div class=\"flex flex-col gap-2 p-3 px-5\" v-if=\"loading\">\n      <div v-for=\"index in 4\">\n        <div class=\"w-full rounded-lg bg-zinc-100 dark:bg-zinc-800 h-10 animate-pulse\"></div>\n      </div>\n    </div>\n\n    <div class=\"flex flex-col grow overflow-auto shrink p-3\" v-else>\n      <RouterLink\n        :to=\"`/library/${snippet.id}`\"\n        class=\"flex flex-row px-2 py-2 pr-4 cursor-pointer transition-all group relative rounded-lg\"\n        v-for=\"(snippet, index) in snippets\"\n        :class=\"\n          snippet.id == route.params.id ? 'text-zinc-900 dark:text-zinc-100 bg-zinc-100 dark:bg-zinc-800' : 'hover:text-zinc-900 hover:dark:text-zinc-100 hover:bg-zinc-100 dark:hover:bg-zinc-800'\n        \"\n      >\n        <div class=\"flex flex-row items-center w-full gap-2\">\n          <div class=\"flex flex-col grow gap-1 max-w-full overflow-hidden\">\n            <div class=\"flex flex-row gap-3 items-center\">\n              <div class=\"aspect-square h-6 rounded-md flex flex-col justify-center items-center bg-zinc-100 dark:bg-zinc-800\" :class=\"returnSnippetColor(snippet)\">\n                <AppIcon :icon=\"returnSnippetIcon(snippet)\" class=\"text-xl\" />\n              </div>\n\n              <div class=\"truncate grow text-sm\" v-html=\"snippet.title.rendered\"></div>\n            </div>\n          </div>\n        </div>\n      </RouterLink>\n\n      <div v-if=\"!snippets.length && !loading\" class=\"text-sm text-center text-zinc-500 dark:text-zinc-400 px-6 py-6\">\n        {{ __(\"No snippets found. Try a different search.\", \"snipvault\") }}\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":["snippets","ref","searchController","loading","pagination","appStore","getSnippets","useAppStore","params","args","endpoint","response","remoteSnippets","error","notify","route","useRoute","useRouter","returnSnippetIcon","snippet","returnSnippetColor","language","previousPage","nextPage","watch"],"mappings":"sOAEO,MAAMA,EAAWC,EAAI,EAAE,EACRA,EAAI,EAAE,EACrB,MAAMC,EAAmBD,EAAI,IAAI,EAC3BE,EAAUF,EAAI,EAAK,EACnBG,EAAaH,EAAI,CAAE,SAAU,GAAI,KAAM,EAAG,OAAQ,GAAI,MAAO,EAAG,YAAa,CAAC,CAAE,ECD7F,IAAII,EAEG,MAAMC,EAAc,SAAY,CAChCD,IACHA,EAAWE,EAAa,GAG1BF,EAAS,YAAY,UAAW,EAAI,EACpCF,EAAQ,MAAQ,GAGhB,MAAMK,EAAS,IAAI,gBAAgB,CACjC,SAAUJ,EAAW,MAAM,SAC3B,KAAMA,EAAW,MAAM,KACvB,OAAQA,EAAW,MAAM,MAC7B,CAAG,EAEKK,EAAO,CACX,QAAS,CACP,OAAQ,kBACT,CACF,EACGP,EAAiB,QACnBO,EAAK,OAASP,EAAiB,MAAM,QAGvC,GAAI,CAEF,MAAMQ,EAAW,qDAAqDF,EAAO,SAAU,CAAA,GACjFG,EAAW,MAAM,MAAMD,EAAUD,CAAI,EAO3C,GALAJ,EAAS,YAAY,UAAW,EAAK,EACrCF,EAAQ,MAAQ,GAGZ,CAACQ,GACD,CAACA,EAAS,GAAI,OAGlBP,EAAW,MAAM,YAAc,SAASO,EAAS,QAAQ,IAAI,iBAAiB,EAAG,EAAE,EACnFP,EAAW,MAAM,MAAQ,SAASO,EAAS,QAAQ,IAAI,YAAY,EAAG,EAAE,EAGxE,MAAMC,EAAiB,MAAMD,EAAS,KAAM,EAE5CX,EAAS,MAAQ,CAAC,GAAGY,CAAc,CACpC,OAAQC,EAAO,CACdR,EAAS,YAAY,UAAW,EAAK,EACrCF,EAAQ,MAAQ,GACZU,EAAM,OAAS,cAGjBC,EAAO,CAAE,MAAOD,EAAM,KAAM,QAASA,EAAM,QAAS,KAAM,QAAS,CAEzE,CACA,o/CC3CiBN,EAAY,EAO7B,MAAMQ,EAAQC,EAAS,EACRC,EAAU,EACPhB,EAAI,CACpB,CAAE,MAAO,MAAO,KAAM,GAAM,MAAO,KAAM,EACzC,CAAE,MAAO,aAAc,KAAM,GAAM,MAAO,YAAa,EACvD,CAAE,MAAO,MAAO,KAAM,GAAM,MAAO,KAAM,EACzC,CAAE,MAAO,OAAQ,KAAM,GAAM,MAAO,MAAO,EAC3C,CAAE,MAAO,OAAQ,KAAM,GAAM,MAAO,MAAO,CAC5C,CAAA,EAMK,MAAAiB,EAAqBC,GAClBA,EAAQ,KAAK,iBAAmBA,EAAQ,KAAK,iBAAiB,cAAgB,OAGjFC,EAAsBD,GAAY,CAChC,MAAAE,EAAWF,EAAQ,KAAK,iBAE1B,OAAAE,GAAY,MAAc,kBAC1BA,GAAY,aAAqB,iBACjCA,GAAY,MAAc,eAC1BA,GAAY,OAAe,gBAC3BA,GAAY,OAAe,kBAExB,cACT,EAEMC,EAAe,IAAM,CACzBlB,EAAW,MAAM,OACLE,EAAA,CACd,EAEMiB,EAAW,IAAM,CACrBnB,EAAW,MAAM,OACLE,EAAA,CACd,EAEY,OAAAA,EAAA,EAEZkB,EACE,IAAMpB,EAAW,MAAM,OACvB,IAAM,CACJA,EAAW,MAAM,KAAO,EAEpBF,EAAiB,OACnBA,EAAiB,MAAM,MAAM,EAIdA,EAAA,MAAQ,IAAI,gBAEjBI,EAAA,CAAA,CAEhB"}