import{e as n,u as F,J as L,q as M,g as x,s as g,j as s,A as T,B as j,t as o,i as r,w as m,p as N,k as v,a as P,c as R,o as w,D as _,z as O,S as y}from"../app.build.DVcfFWU_.js";import"./constants-OryjEDvQ.js";import{l as k}from"./lmnFetch-DeRrp9BG.js";import{_ as E}from"./index-CqlI0lnC.js";import{_ as b}from"./index-CRgHs0Pg.js";import{n as $}from"./notify-CXlPex_L.js";import{l as H,c as J}from"./loadDirectory-DyHUXo09.js";n(null);const z=n(null),A={class:"border-b border-zinc-200 dark:border-zinc-700 px-6 py-3 flex flex-row gap-3"},G={class:"grow flex flex-col"},W={class:"font-mono text-xs text-zinc-500 dark:text-zinc-400"},q={class:"flex flex-row items-center gap-3"},K={class:"grow flex flex-row max-w-full overflow-hidden"},I={class:"border-l border-zinc-200 dark:border-zinc-700 w-[340px] shrink-0"},Q={class:"col-span-3 flex flex-row place-content-between items-center p-6 border-b border-zinc-200 dark:border-zinc-700 text-zinc-900 dark:text-zinc-100"},X=["innerHTML"],Y={class:"p-6 grid grid-cols-3 gap-3"},Z={class:"flex flex-col justify-center"},ee={class:"text-sm text-zinc-500 dark:text-zinc-400"},te={class:"flex flex-col justify-center"},ae={class:"text-sm text-zinc-500 dark:text-zinc-400"},se={class:"flex flex-col justify-center"},le={class:"text-sm text-zinc-500 dark:text-zinc-400"},oe={class:"col-span-2"},ne={class:"flex flex-col justify-center"},ie={class:"text-sm text-zinc-500 dark:text-zinc-400"},re={class:"col-span-2"},ce={class:"flex flex-col justify-center"},de={class:"text-sm text-zinc-500 dark:text-zinc-400"},ue={class:"col-span-2"},pe={key:0,class:"col-span-3 rounded-lg bg-rose-500/10 border border-rose-600/60 p-4 text-sm mt-6"},ye={__name:"index",setup(fe){const d=F();n(!0);const p=n(!1),f=n(!1);n(!1),n(null);const t=n(null),h=n(null),u=P(),S=R(),V=async()=>{d.updateState("loading",!0),f.value=!1;const a={endpoint:"snipvault/v1/filesystem/read/",type:"GET",params:{path:u.params.filepath}},e=await k(a);d.updateState("loading",!1),e&&(t.value=e.data,h.value=JSON.parse(JSON.stringify(e.data)),u.meta.name=t.value.filename,O(()=>{f.value=!0}))},C=async()=>{d.updateState("loading",!0),p.value=!0;const a={endpoint:"snipvault/v1/filesystem/write/",type:"POST",params:{},data:{content:t.value.content,path:u.params.filepath,filename:t.value.filename}},e=await k(a);d.updateState("loading",!1),p.value=!1,e&&(y.value=!1,t.value.path=e.data.path,$({title:(0,window.wp.i18n.__)("File saved"),type:"success"}),H(J.value,!0),S.push(`/file-browser/${e.data.path}`))},B=()=>{const a=t.value.content,e=t.value.filename,i=new Blob([a],{type:"text/plain"}),l=URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download=e,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)},U=a=>{if(a===0)return"0 Bytes";const e=1024,i=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,l)).toFixed(2))+" "+i[l]},D=a=>{const e=new Date(a);return e.toLocaleDateString()+" "+e.toLocaleTimeString()};return L(()=>{u.params.filepath&&V()}),M(()=>t.value,(a,e)=>{f.value&&a.content!=h.value.content&&(y.value=!0)},{deep:!0}),(a,e)=>{var i;return t.value?(w(),x("div",{class:"flex flex-col w-full h-full",key:(i=t.value)==null?void 0:i.path},[s("div",A,[s("div",G,[T(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.filename=l),class:"bg-white dark:bg-zinc-900 focus:outline-0",style:{"field-sizing":"content"}},null,512),[[j,t.value.filename]]),s("div",W,o(t.value.path),1)]),s("div",q,[r(v,{onClick:e[1]||(e[1]=()=>N(z).formatDocument()),type:"default",class:"text-sm"},{default:m(()=>[_(o(a.__("Format","snipvault")),1)]),_:1}),r(v,{onClick:B,type:"default",class:"text-sm",icon:"download"},{default:m(()=>[_(o(a.__("Download","snipvault")),1)]),_:1}),r(v,{onClick:C,type:"primary",class:"text-sm",loading:p.value},{default:m(()=>[_(o(a.__("Save","snipvault")),1)]),_:1},8,["loading"])])]),s("div",K,[r(E,{ref_key:"codeeditor",ref:z,modelValue:t.value.content,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.content=l),language:t.value.language.toUpperCase(),ensurePHP:!1,class:"grow shrink overflow-hidden"},null,8,["modelValue","language"]),s("div",I,[s("div",Q,[s("div",{class:"",innerHTML:t.value.filename},null,8,X)]),s("div",Y,[s("div",Z,[s("span",ee,o(a.__("Name","snipvault")),1)]),r(b,{type:"text",class:"col-span-2",modelValue:t.value.filename,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.filename=l)},null,8,["modelValue"]),s("div",te,[s("span",ae,o(a.__("Path","snipvault")),1)]),r(b,{type:"text",class:"col-span-2",disabled:!0,modelValue:t.value.path,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.path=l),copy:!0},null,8,["modelValue"]),s("div",se,[s("span",le,o(a.__("Language","snipvault")),1)]),s("div",oe,o(t.value.language),1),s("div",ne,[s("span",ie,o(a.__("Modified","snipvault")),1)]),s("div",re,o(D(t.value.modified)),1),s("div",ce,[s("span",de,o(a.__("Size","snipvault")),1)]),s("div",ue,o(U(t.value.size)),1),t.value.is_core_file?(w(),x("div",pe,o(a.__("This is likely a WordPress core file. Changes made here will probably be lost during WordPress updates. Use hooks or custom plugins instead.","snipvault")),1)):g("",!0)])])])])):g("",!0)}}};export{ye as default};
//# sourceMappingURL=index-7S61D7H2.js.map
