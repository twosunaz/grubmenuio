import{m as te,b as se,G as ae,J as le,g as c,o as u,A as ne,i as r,X as ie,j as e,I as oe,p as h,w as V,s as D,_ as B,T as re,f as I,n as O,t as n,Y as de,W as ce,u as ue,e as _,k as C,F as U,v as R,l as W,D as T}from"../app.build.DVcfFWU_.js";import{_ as z}from"./index-CRgHs0Pg.js";import{_ as j,i as pe}from"./index-D1jnwpSe.js";import{_ as _e}from"./index-Bt0YRkAh.js";import{l as $}from"./lmnFetch-DeRrp9BG.js";import{n as m}from"./notify-CXlPex_L.js";import{s as G,f as J}from"./constants-OryjEDvQ.js";const ve={class:"relative inline-flex"},fe={key:0,class:"absolute inset-0 flex flex-col place-content-center"},K={__name:"index",props:te(["dynamic"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const o=se(i,"modelValue"),f=ae(),d=i,p=v=>v==null;return le(()=>{p(d.dynamic)||(o.value=d.dynamic)}),(v,a)=>(u(),c("div",ve,[ne(e("input",oe({type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=w=>o.value=w),class:"appearance-none w-4 h-4 text-indigo-600 bg-zinc-100 border-zinc-300 rounded focus:ring-indigo-500 dark:focus:ring-indigo-600 dark:ring-offset-zinc-800 focus:ring-2 dark:bg-zinc-700 dark:border-zinc-600 checked:bg-indigo-500"},h(f)),null,16),[[ie,o.value]]),r(re,null,{default:V(()=>[o.value?(u(),c("div",fe,[r(B,{icon:"tick",class:"text-white mx-auto"})])):D("",!0)]),_:1})]))}},ge=(i=window.location.hostname)=>{const o=["dev","development","staging","test","testing","beta","qa","uat"],d=i.split(".").includes("instawp"),p=g=>o.some(x=>g.startsWith(`${x}.`)||g===x),v=i==="localhost"||i==="instawp"||i==="[::1]"||i.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),a=i.endsWith(".local")||i.endsWith(".test")||i.endsWith(".localhost")||i.endsWith(".example")||i.endsWith(".invalid")||i.endsWith(".dev"),w=/^10\./.test(i)||/^172\.(1[6-9]|2\d|3[01])\./.test(i)||/^192\.168\./.test(i);return d||v||a||w||p(i)||!1},me={class:"relative flex h-2 w-2"},he={class:"font-mono"},be={__name:"index",props:["status","text"],setup(i){const o=i,f=I(()=>o.status==="success"?" text-green-600 border-green-300 dark:text-green-700 dark:border-green-700/80":o.status==="warning"?" text-orange-600 border-orange-300 dark:text-orange-700 dark:border-orange-700/80":o.status==="danger"?" text-red-500 border-red-30 dark:text-red-700 dark:border-red-700/80":"text-zinc-500 border-zinc-300 dark:text-zinc-400 dark:border-zinc-700"),d=I(()=>o.status==="success"?"bg-green-300 dark:bg-green-700/80":o.status==="warning"?"bg-orange-300 dark:bg-orange-700/80":o.status==="danger"?"bg-red-300 dark:bg-red-700/80":"bg-zinc-300 dark:bg-zinc-700"),p=I(()=>o.status==="success"?"bg-green-500 dark:bg-green-700/80":o.status==="warning"?"bg-orange-500  dark:bg-orange-700/80":o.status==="danger"?"bg-red-500  dark:bg-red-700/80":"bg-zinc-500  dark:bg-zinc-700");return(v,a)=>(u(),c("div",{class:O(["flex gap-2 flex-row relative items-center rounded-md text-xs py-1 px-2 inline-flex border transition-all",f.value])},[e("span",me,[e("span",{class:O(["animate-ping absolute inline-flex h-full w-full rounded-full opacity-75",d.value]),style:{"animation-duration":"1.5s"}},null,2),e("span",{class:O(["relative inline-flex rounded-full h-2 w-3",p.value])},null,2)]),e("div",he,n(i.text),1)],2))}},xe={class:"flex flex-col gap-6 w-full overflow-auto h-full"},we={class:"flex flex-row items-center place-content-between p-6 border-b border-zinc-200 dark:border-zinc-700"},ye={class:"col-span-3 text-lg text-zinc-900 dark:text-zinc-100"},ke={class:"flex flex-row justify-end items-center gap-3"},ze={key:0,class:"grid grid-cols-3 gap-12 p-6 gap-x-24"},Ve=e("div",{class:"w-full rounded-lg bg-zinc-100 dark:bg-zinc-800 h-8 animate-pulse"},null,-1),Se=e("div",{class:"col-span-2 rounded-lg bg-zinc-100 dark:bg-zinc-800 h-8 animate-pulse"},null,-1),Pe={key:1,class:"grid grid-cols-3 gap-12 p-6 gap-x-24"},Ce={class:"flex flex-col"},Te={class:""},$e={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},De={key:0,class:"col-span-2"},Ae={class:"flex flex-row gap-3"},Le={key:1,class:"col-span-2"},Ne={class:"flex flex-row gap-3"},Ee={key:0,class:"bg-emerald-100 dark:bg-emerald-600/20 border border-emerald-400 dark:border-emerald-700 p-2 rounded-lg text-sm mt-3"},Ie={class:"flex flex-col"},Oe={class:""},Ue={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},We={class:"col-span-2"},je={class:"flex flex-col"},Ke={class:""},Re={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},Ge={class:"col-span-2 flex flex-row items-start"},Je={class:"flex flex-col"},qe={class:""},Be={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},Fe={class:"col-span-2"},Me={class:"flex flex-col"},He={class:""},Qe={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},Ye={class:"col-span-2"},Ze={class:"flex flex-col"},Xe={class:""},et={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},tt={class:"col-span-2"},st={class:"flex flex-col"},at={class:""},lt={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},nt={class:"col-span-2"},it={class:"flex flex-col"},ot={class:""},rt={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},dt={class:"col-span-2 flex flex-col gap-2"},ct={class:"dark:text-zinc-400"},ut={class:"dark:text-zinc-400"},pt={class:"dark:text-zinc-400"},_t={class:"flex flex-col"},vt={class:""},ft={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-1"},gt={class:"col-span-2"},mt={class:"flex flex-row gap-3 mb-4"},ht={class:"max-h-80 overflow-y-auto border border-zinc-200 dark:border-zinc-700 rounded-lg"},bt={key:0,class:"w-full"},xt={class:"bg-zinc-100 dark:bg-zinc-800"},wt={class:"text-left p-3"},yt={class:"text-left p-3"},kt={class:"text-right p-3 w-24"},zt={class:"p-3 font-mono text-sm"},Vt={class:"p-3 overflow-hidden text-ellipsis"},St={class:"p-3 text-right"},Pt=["onClick"],Ct={key:1,class:"p-6 text-center text-zinc-500 dark:text-zinc-400"},Tt={class:"text-sm mt-2 text-zinc-500 dark:text-zinc-400"},q="7a270461-0edc-45ce-a72a-40180d7aec7c",Ot={__name:"index",props:["modal"],setup(i){de();const{setColorScheme:o,userPreference:f}=ce(),d=ue(),p=_(!1),v=_(null),a=_({}),w=_({}),g=_(""),x=_(!1),S=_(!1),A=_(!1),y=_(""),k=_(""),F=async()=>{d.updateState("loading",!0),p.value=!0;const s=await $({endpoint:"wp/v2/settings",params:{}});d.updateState("loading",!1),p.value=!1,s&&(!s.data.snipvault_settings||!pe(s.data.snipvault_settings)||(a.value=s.data.snipvault_settings,a.value.php_global_variables||(a.value.php_global_variables=[]),w.value=JSON.parse(JSON.stringify(s.data.snipvault_settings)),a.value.license_key&&(await M()||Q())))},M=async()=>{const t={key:a.value.license_key,activation_id:a.value.instance_id,organization_id:q};try{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},l=await fetch("https://api.polar.sh/v1/customer-portal/license-keys/validate",s);if(!l.ok)return!1;if((await l.json()).status)return!0}catch{return!1}return!1},H=async()=>{d.updateState("loading",!0),S.value=!0;const t={key:g.value,label:d.state.siteURL,organization_id:q};try{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},l=await fetch("https://api.polar.sh/v1/customer-portal/license-keys/activate",s);if(d.updateState("loading",!1),S.value=!1,!l.ok){const P=await l.json();m({title:(0,window.wp.i18n.__)("Failed to activate license","snipvault"),message:P.detail});return}const b=await l.json();a.value.license_key=g.value,a.value.instance_id=b.id,L()}catch(s){m({title:(0,window.wp.i18n.__)("Failed to activate license","snipvault"),message:s.message}),d.updateState("loading",!1),S.value=!1}},Q=()=>{a.value.license_key="",a.value.instance_id="",L()},L=async()=>{d.updateState("loading",!0),A.value=!0;let t={snipvault_settings:JSON.parse(JSON.stringify(a.value))};const l=await $({endpoint:"wp/v2/settings",type:"POST",params:{},data:t});d.updateState("loading",!1),A.value=!1,l&&(m({title:(0,window.wp.i18n.__)("Settings updated!","snipvault"),type:"success"}),d.updateState("snipvault_settings",a.value))},Y=async()=>{if(await v.value.show({title:(0,window.wp.i18n.__)("Are you sure?","snipvault"),message:(0,window.wp.i18n.__)("This will delete all snippets and folders from your database. This action can't be undone.","snipvault"),okButton:(0,window.wp.i18n.__)("Yes delete it all","snipvault")})){x.value=!0;try{const s=G.value.map(N=>{const E={endpoint:`wp/v2/svsnippets/${N.id}`,type:"DELETE",params:{force:!0}};return $(E)}),l=J.value.map(N=>{const E={endpoint:`wp/v2/svfolders/${N.id}`,type:"DELETE",params:{force:!0}};return $(E)}),[b,P]=await Promise.all([Promise.all(s),Promise.all(l)]);m({title:(0,window.wp.i18n.__)("Deletion Complete","snipvault"),message:(0,window.wp.i18n.__)(`Successfully deleted ${b.length} snippets and ${P.length} folders.`,"snipvault"),type:"success"}),G.value=[],J.value=[]}catch{m({title:(0,window.wp.i18n.__)("Deletion Error","snipvault"),message:(0,window.wp.i18n.__)("There was a problem deleting your content. Please try again.","snipvault"),type:"error"})}finally{x.value=!1}}},Z=t=>{if(!t||t.trim()==="")return"";let s=t.trim().replace(/[^a-zA-Z0-9_]/g,"_");return/^[a-zA-Z_]/.test(s)||(s="_"+s),s},X=()=>{if(!y.value.trim()||!k.value.trim()){m({title:(0,window.wp.i18n.__)("Invalid Input","snipvault"),message:(0,window.wp.i18n.__)("Both key and value must be provided","snipvault"),type:"error"});return}const t=Z(y.value);if(!t){m({title:(0,window.wp.i18n.__)("Invalid Input","snipvault"),message:(0,window.wp.i18n.__)("Please provide a valid variable name","snipvault"),type:"error"});return}if(a.value.php_global_variables.some(l=>l.key===t.trim())){m({title:(0,window.wp.i18n.__)("Duplicate Key","snipvault"),message:(0,window.wp.i18n.__)("This variable key already exists","snipvault"),type:"error"});return}a.value.php_global_variables.push({key:t.trim(),value:k.value.trim()}),y.value="",k.value=""},ee=t=>{a.value.php_global_variables.splice(t,1)};return F(),(t,s)=>(u(),c("div",xe,[e("div",we,[e("div",ye,n(t.__("Plugin settings","snipvault")),1),e("div",ke,[r(C,{type:"primary",onClick:L,loading:A.value},{default:V(()=>[T(n(t.__("Save","snipvault")),1)]),_:1},8,["loading"])])]),p.value?(u(),c("div",ze,[(u(),c(U,null,R(3,l=>(u(),c(U,null,[Ve,Se],64))),64))])):D("",!0),p.value?D("",!0):(u(),c("div",Pe,[e("div",Ce,[e("span",Te,n(t.__("Licence key","snipvault")),1),e("span",$e,n(t.__("Enter a valid licence key to activate SnipVault.","snipvault")),1)]),a.value.license_key||a.value.instance_id?(u(),c("div",De,[e("div",Ae,[r(be,{status:"success",text:t.__("Licence Active","snipvault"),class:"text-lg py-2"},null,8,["text"])])])):(u(),c("div",Le,[e("div",Ne,[r(z,{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=l=>g.value=l),class:"col-span-2 grow",icon:"key",placeholder:t.__("SnipVault licence key","snipvault")},null,8,["modelValue","placeholder"]),r(C,{type:"default",disabled:!g.value,onClick:H,loading:S.value},{default:V(()=>[T(n(t.__("Activate","snipvault")),1)]),_:1},8,["disabled","loading"])]),h(ge)()?(u(),c("div",Ee,n(t.__("Development server detected, no need to activate your licence key.","snipvault")),1)):D("",!0)])),e("div",Ie,[e("span",Oe,n(t.__("Anthropic API key","snipvault")),1),e("span",Ue,n(t.__("Enter your Anthropic API key to enable AI features and Claude integration","snipvault")),1)]),e("div",We,[r(z,{modelValue:a.value.anthropic_key,"onUpdate:modelValue":s[1]||(s[1]=l=>a.value.anthropic_key=l),class:"w-1/2",icon:"key",type:"password",placeholder:"xxxx-xxxx-xxxx-xxxx"},null,8,["modelValue"])]),e("div",je,[e("span",Ke,n(t.__("Disable file browsing","snipvault")),1),e("span",Re,n(t.__("Turn off the server file browsing functionality for all users","snipvault")),1)]),e("div",Ge,[r(j,{modelValue:a.value.file_browsing_disabled,"onUpdate:modelValue":s[2]||(s[2]=l=>a.value.file_browsing_disabled=l),style:{width:"50%"}},null,8,["modelValue"])]),e("div",Je,[e("span",qe,n(t.__("Disable SQL editor","snipvault")),1),e("span",Be,n(t.__("Turn off the SQL database editor functionality for all users","snipvault")),1)]),e("div",Fe,[r(j,{modelValue:a.value.sql_editor_disabled,"onUpdate:modelValue":s[3]||(s[3]=l=>a.value.sql_editor_disabled=l),style:{width:"50%"}},null,8,["modelValue"])]),e("div",Me,[e("span",He,n(t.__("Disable WP-CLI","snipvault")),1),e("span",Qe,n(t.__("Turn off the WordPress command line interface functionality for all users","snipvault")),1)]),e("div",Ye,[r(j,{modelValue:a.value.wp_sql_disabled,"onUpdate:modelValue":s[4]||(s[4]=l=>a.value.wp_sql_disabled=l),style:{width:"50%"}},null,8,["modelValue"])]),e("div",Ze,[e("span",Xe,n(t.__("Delete snippets & folders","snipvault")),1),e("span",et,n(t.__("Permanently delete all stored code snippets and organizational folders","snipvault")),1)]),e("div",tt,[r(C,{type:"danger",onClick:Y,loading:x.value},{default:V(()=>[T(n(t.__("Delete","snipvault")),1)]),_:1},8,["loading"])]),e("div",st,[e("span",at,n(t.__("Code editor font size","snipvault")),1),e("span",lt,n(t.__("Alter the default code editor font size. Default is 12.","snipvault")),1)]),e("div",nt,[r(z,{modelValue:a.value.code_font_size,"onUpdate:modelValue":s[5]||(s[5]=l=>a.value.code_font_size=l),class:"w-1/2",type:"number",placeholder:"12"},null,8,["modelValue"])]),e("div",it,[e("span",ot,n(t.__("Theme","snipvault")),1),e("span",rt,n(t.__("Choose between light, dark, or system default color theme for the SnipVault interface","snipvault")),1)]),e("div",dt,[e("label",{class:"flex flex-row items-center gap-2 px-2 mt-2 cursor-pointer",onClick:s[6]||(s[6]=W(l=>h(o)("system"),["stop","prevent"]))},[r(K,{dynamic:h(f)=="system"},null,8,["dynamic"]),e("span",ct,n(t.__("System","uixpress")),1)]),e("label",{class:"flex flex-row items-center gap-2 px-2 cursor-pointer",onClick:s[7]||(s[7]=W(l=>h(o)("light"),["stop","prevent"]))},[r(K,{dynamic:h(f)=="light"},null,8,["dynamic"]),e("span",ut,n(t.__("Light","uixpress")),1)]),e("label",{class:"flex flex-row items-center gap-2 px-2 cursor-pointer",onClick:s[8]||(s[8]=W(l=>h(o)("dark"),["stop","prevent"]))},[r(K,{dynamic:h(f)=="dark"},null,8,["dynamic"]),e("span",pt,n(t.__("Dark","uixpress")),1)])]),e("div",_t,[e("span",vt,n(t.__("PHP Global Variables","snipvault")),1),e("span",ft,n(t.__("Define global PHP variables that will be available in your code snippets","snipvault")),1)]),e("div",gt,[e("div",mt,[r(z,{modelValue:y.value,"onUpdate:modelValue":s[9]||(s[9]=l=>y.value=l),class:"grow",placeholder:"Variable name"},null,8,["modelValue"]),r(z,{modelValue:k.value,"onUpdate:modelValue":s[10]||(s[10]=l=>k.value=l),class:"grow",placeholder:"Variable value"},null,8,["modelValue"]),r(C,{type:"default",onClick:X},{default:V(()=>[T(n(t.__("Add","snipvault")),1)]),_:1})]),e("div",ht,[a.value.php_global_variables&&a.value.php_global_variables.length>0?(u(),c("table",bt,[e("thead",xt,[e("tr",null,[e("th",wt,n(t.__("Variable Name","snipvault")),1),e("th",yt,n(t.__("Value","snipvault")),1),e("th",kt,n(t.__("Action","snipvault")),1)])]),e("tbody",null,[(u(!0),c(U,null,R(a.value.php_global_variables,(l,b)=>(u(),c("tr",{key:b,class:"border-t border-zinc-200 dark:border-zinc-700"},[e("td",zt,n(l.key),1),e("td",Vt,n(l.value),1),e("td",St,[e("button",{onClick:P=>ee(b),class:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300"},[r(B,{icon:"trash",class:"w-5 h-5"})],8,Pt)])]))),128))])])):(u(),c("div",Ct,n(t.__("No global variables defined yet","snipvault")),1))]),e("div",Tt,n(t.__("These variables will be available globally in all PHP script execution contexts","snipvault")),1)])])),r(_e,{ref_key:"confirm",ref:v},null,512)]))}};export{Ot as default};
//# sourceMappingURL=index-CpvGQOEp.js.map
