!function(a){var o={init:function(){a("#orderable_cos_nextstep").length&&a("#orderable_cos_nextstep").select2(),a("#orderable_cos_color").length&&a("#orderable_cos_color").wpColorPicker(),a("#title").change(o.set_slug_on_title_change),a("#orderable_cos_status_type").change(o.on_status_change),"orderable_status"!==pagenow&&"edit-orderable_status"!==pagenow||a(document).on("click",".submitdelete",o.on_status_post_delete),o.check_if_slug_already_exists(),o.validate_form()},set_slug_on_title_change:function(){var e;a("#orderable_cos_slug").length&&!a("#orderable_cos_slug").prop("readonly")&&(e=a("#title").val().toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"").slice(0,17),a("#orderable_cos_slug").val(e))},on_status_change:function(){var e=a(this).val();"custom"===e?(a("#orderable_cos_slug").val(""),a("#orderable_cos_slug").prop("readonly",!1)):(a("#orderable_cos_slug").val(e),a("#orderable_cos_slug").prop("readonly",!0),a("#orderable_cos_slug").removeClass("orderable-field-error"),a(".orderable-fields-row__body-row-right--slug .orderable-field-error-message").text(""))},on_status_post_delete:function(e){confirm(orderable_pro_custom_order_status.i18n.move_to_trash)||e.preventDefault()},check_if_slug_already_exists:function(){var e=o.debounce(function(){a("#orderable_cos_slug").val()&&a.ajax({url:ajaxurl,type:"POST",data:{action:"orderable_cos_check_slug_exists",slug:a("#orderable_cos_slug").val(),nonce:orderable_pro_custom_order_status.nonce}}).done(function(e){e.success?(a("#orderable_cos_slug").removeClass("orderable-field-error"),a(".orderable-fields-row__body-row-right--slug .orderable-field-error-message").text("")):(a("#orderable_cos_slug").addClass("orderable-field-error"),a(".orderable-fields-row__body-row-right--slug .orderable-field-error-message").text(e.data.message))})});a("#orderable_cos_slug").keyup(e)},debounce:function(o,t=300){let a;return(...e)=>{clearTimeout(a),a=setTimeout(()=>{o.apply(this,e)},t)}},validate_form:function(){a("#post").submit(function(){if(a("#orderable_cos_slug").hasClass("orderable-field-error"))return alert(orderable_pro_custom_order_status.i18n.slug_already_exists),!1;wp.hooks.applyFilters("orderable_cos_error_message",!1)})}},e=function(){a("#orderable_cos_icon_family").change(function(){var e=a(this).val();a(".orderable-cos-icons-field__list").hide(),a(".orderable-cos-icons-field__list--"+e).show()}).trigger("change"),a(".orderable-cos-icons-field__icon").click(function(){var e=a(this).data("icon"),o=a("#orderable_cos_icon_family").val(),t="",t="fontawesome"===o?"fa":"woocommerce"===o?"wooicon":"dashicons";a("#orderable_cos_icon").val(e),a(".orderable-cos-icons-field__icon").removeClass("orderable-cos-icons-field__icon--selected"),a(this).addClass("orderable-cos-icons-field__icon--selected"),a("#orderable-cos-icons-preview").removeClass().addClass(t).addClass(e)})};a(document).ready(function(){o.init(),e()})}(jQuery),function(t){0!==t("#orderable-cos-notifications").length&&new Vue({el:"#orderable-cos-notifications",data:{notifications:[],locations:t("#orderable-cos-notifications").data("locations"),wa_templates:[],wa_templates_loading:!1,i18n:{are_your_sure:orderable_pro_custom_order_status.i18n.are_your_sure,email_title:orderable_pro_custom_order_status.i18n.email_title,email_subject:orderable_pro_custom_order_status.i18n.email_subject,enter_recipient_email:orderable_pro_custom_order_status.i18n.enter_recipient_email,enter_valid_email:orderable_pro_custom_order_status.i18n.enter_valid_email}},mounted:function(){var e=t("#orderable-cos-notifications").data("notifications");t("#orderable-cos-wa-templates-json").length&&(this.wa_templates=t("#orderable-cos-wa-templates-json").data("templates")),"object"==typeof e&&(e.forEach(e=>{e.is_open=!1,void 0===e.enabled&&(e.enabled=!0),void 0===e.location&&(e.location="")}),this.notifications=e),t("#publish").on("click",this.validate_notifications),wp.hooks.addFilter("orderable_cos_error_message","orderable_cos",this.validate_notifications)},methods:{add_notification:function(){this.notifications.push({id:this.generate_random_number(),enabled:"1",type:"email",recipient:"customer",recipient_custom_email:"",recipient_custom_number:"",title:this.i18n.email_title,subject:this.i18n.email_subject,location:"",message:"",from_name:"",include_order_table:!0,include_customer_info:!0,is_open:!1,wa_template_id:!1,wa_variables:[]})},remove_notification:function(e){confirm(this.i18n.are_your_sure)&&this.notifications.splice(this.notifications.indexOf(e),1)},handle_wa_template_change:function(o){var e=this.wa_templates.find(e=>e.id===o.wa_template_id);e&&(e=e.components.find(e=>"BODY"===e.type))&&(o.message=e.text,Vue.set(o,"wa_variables",[]),e=e.text.match(/{{\d*}}/g))&&e.length&&e.forEach(e=>{Vue.set(o.wa_variables,o.wa_variables.length,"")})},on_type_change:function(e){"whatsapp"===e.type&&(e.message="")},refresh_templates:function(){var o=this;o.wa_templates_loading=!0,t.post(ajaxurl,{action:"orderable_wa_refresh_templates"}).success(function(e){o.wa_templates=e.data.data}).always(function(){o.wa_templates_loading=!1})},validate_notifications:function(){var t=[];return this.notifications.forEach(e=>{if("email"===e.type&&"custom"===e.recipient){if(!e.recipient_custom_email)return e.is_open=!0,t.push(this.i18n.enter_recipient_email),t;var o=e.recipient_custom_email;if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o))return t.push(this.i18n.enter_valid_email),e.is_open=!0,t}if(!e.subject||!e.title)return e.is_open=!0,t}),t},notification_title:function(e){var o={email:orderable_pro_custom_order_status.i18n.email,sms:orderable_pro_custom_order_status.i18n.sms,whatsapp:orderable_pro_custom_order_status.i18n.whatsapp},t="custom"===e.recipient?"email"===e.type?e.recipient_custom_email:e.recipient_custom_number:window.orderable_pro_custom_order_status.i18n[e.recipient];return`${o[e.type]} ${orderable_pro_custom_order_status.i18n.to} `+t},notification_icon_class:function(e){return{email:"dashicons dashicons-email-alt",sms:"fa fa-commenting-o",whatsapp:"fa fa-whatsapp"}[e.type]},capitalize:function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},generate_random_number:function(){return Math.floor(Math.random()*(1e12-1e3+1))+1e3}},computed:{notifications_json:function(){return JSON.stringify(this.notifications)}}})}(jQuery);