!function(o,e){"use strict";var i={on_ready(){i.init_visual_fields(),o(".orderable-product-fields input, .orderable-product-fields select").change(function(){i.update_price(o(this))}),o(e).on("orderable_variation_set",".orderable-product__add-to-order, .orderable-product__update-cart-item",function(e,r){var d;r.variation_id&&(d=o(this).closest(".orderable-drawer").find(".orderable-product-fields-group")).length&&((d=d.closest(".orderable-product-fields-group-wrap")).data("regular-price",r.variation.display_price),d.data("price",r.variation.display_price),i.update_price(o(".orderable-product-fields").eq(0)))}),o(".orderable-product-fields-group").each(function(){var e=o(this).find("input,select").eq(0);i.update_price(e)})},init_visual_fields(){o(".orderable-product-fields--visual .orderable-product-option").click(function(){var e=o(this).find("input");e.prop("checked",!e.prop("checked")),e.trigger("change")}),o(".orderable-product-option__hidden-field").change(i.select_deselect_visual_field),o(".orderable-product-option__hidden-field").each(function(){i.select_deselect_visual_field(this)})},select_deselect_visual_field(e){var r,d,e=e instanceof Element?o(e):o(this),a=e.closest(".orderable-product-fields__field");a&&(r=a.hasClass("orderable-product-fields__field--has-max-selection"),d=a.data("max-selection"),r&&(d<a.find(".orderable-product-option__hidden-field:checked").length?(e.prop("checked",!1),jQuery(".orderable-product-fields__max-selection-error").show()):jQuery(".orderable-product-fields__max-selection-error").hide()),a.find(".orderable-product-option").each(function(){var e=o(this);e.find(".orderable-product-option__hidden-field").is(":checked")?e.addClass("orderable-product-option--checked"):e.removeClass("orderable-product-option--checked")}))},update_price(e){var r=e.closest(".orderable-product-fields-group-wrap"),e=e.closest(".orderable-product, .product").find(".orderable-product__actions-price, p.price"),d=parseFloat(r.data("price")),a=parseFloat(r.data("regular-price")),r=i.calculate_price(r),o=d!==a,d=accounting.formatMoney(d+r,{symbol:'<span class="woocommerce-Price-currencySymbol">'+orderable_addons_pro_params.currency.format_symbol+"</span>",decimal:orderable_addons_pro_params.currency.format_decimal_sep,thousand:orderable_addons_pro_params.currency.format_thousand_sep,precision:orderable_addons_pro_params.currency.format_num_decimals,format:orderable_addons_pro_params.currency.format});(o?(o=r+a,o=accounting.formatMoney(o,{symbol:'<span class="woocommerce-Price-currencySymbol">'+orderable_addons_pro_params.currency.format_symbol+"</span>",decimal:orderable_addons_pro_params.currency.format_decimal_sep,thousand:orderable_addons_pro_params.currency.format_thousand_sep,precision:orderable_addons_pro_params.currency.format_num_decimals,format:orderable_addons_pro_params.currency.format}),e.find("del bdi").replaceWith("<bdi>"+o+"</bdi>"),e.find("ins bdi")):e.find("bdi")).replaceWith("<bdi>"+d+"</bdi>")},calculate_price(e){let r=0;return e.find(".orderable-product-fields").each(function(){o(this).find("[data-product-option]").each(function(){var e=o(this);i.is_option_selected(e)&&(e=o(this).data("fees"))&&!isNaN(e)&&(r+=parseFloat(e))})}),r},is_option_selected(e){return!!e&&(e.is("div")?e.hasClass("orderable-product-option--checked"):e.is("option")?e.is(":selected"):void 0)}},r={on_ready(){var e=r.debounce(r.validate,300);o(".orderable-product-fields input, .orderable-product-fields select, .orderable-product-fields textarea").change(r.validate),o(".orderable-product-fields input, .orderable-product-fields select, .orderable-product-fields textarea").keyup(e),r.validate(),r.validate_single_product_page()},validate(){o(".orderable-product-fields--required").each(function(){var e=o(this).hasClass("orderable-product-fields--visual")?o(this):o(this).find("select, input, textarea");r.validate_field(o(this))?e.removeClass("orderable-field--invalid"):(e.addClass("orderable-field--invalid"),o(".orderable-drawer .orderable-product__add-to-order, .orderable-drawer .orderable-product__update-cart-item").attr("disabled","disabled"))})},validate_single_product_page(){o(".single-product form.cart").submit(function(){if(r.validate(),o(this).find(".orderable-field--invalid").length)return alert(orderable_addons_pro_params.i18n.make_a_selection),!1})},validate_field(e){return!e.hasClass("orderable-product-fields--required")||(e.hasClass("orderable-product-fields--visual_radio")||e.hasClass("orderable-product-fields--visual_checkbox")?e.find("input:checked").length:e.hasClass("orderable-product-fields--select")?""!==e.find("select").val():e.hasClass("orderable-product-fields--select")||e.hasClass("orderable-product-fields--text")?""!==e.find("select, input, textarea").val():void 0)},debounce(a,o,i){let t;return function(){const e=this,r=arguments;var d=i&&!t;clearTimeout(t),t=setTimeout(function(){t=null,i||a.apply(e,r)},o),d&&a.apply(e,r)}}};o(e.body).on("orderable-drawer.opened",i.on_ready),o(e.body).on("orderable-drawer.opened",r.on_ready),o(e).ready(i.on_ready),o(e).ready(r.on_ready)}(jQuery,document);